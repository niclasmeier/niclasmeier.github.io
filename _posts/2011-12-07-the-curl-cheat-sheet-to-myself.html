---
layout: post
status: publish
published: true
title: The curl cheat sheet to myself
author:
  display_name: Niclas Meier
  login: niclas
  email: mail@niclas-meier.de
  url: http://www.niclas-meier.de
author_login: niclas
author_email: mail@niclas-meier.de
author_url: http://www.niclas-meier.de
excerpt: "It has been not even a full week building REST style interfaces for the
  <a href=\"http://www.playmakerstudio.com/\">Playmaker Studio</a>
  mobile platform and I am very annoyed of all the <code>curl</code> guides how
  to access your REST API with <code>curl</code>. So here is my cheat sheet on
  this topic. Be aware that the I will update this frequently.\r\n"
wordpress_id: 109
wordpress_url: http://www.niclas-meier.de/?p=109
date: '2011-12-07 15:11:53 +0100'
date_gmt: '2011-12-07 14:11:53 +0100'
categories:
- Technology
- Software development
- REST
tags: []
comments: []
---
<p>It has been not even a full week building REST style interfaces for the <a href="http://www.playmakerstudio.com/">Playmaker Studio</a> mobile platform and I am very annoyed of all the <code>curl</code> guides how to access your REST API with <code>curl</code>. So here is my cheat sheet on this topic. Be aware that the I will update this frequently.
<a id="more"></a><a id="more-109"></a></p>
<h2>Common use cases</h2></p>
<h3>GETting data from a URL</h3>
This is a very simple use case just use:</p>
<pre class="brush:bash">
curl https://graph.facebook.com/740999649
{"id":"740999649","name":"Niclas Meier"}
</pre>
<code>curl</code> will automatically use the HTTP method <code>GET</code>.</p>
<h3>POSTting updates</h3>
In the REST dictionary the HTTP method <code>POST</code> represents the verb 'update'. So updating data implies a <code>POST</code> request to an URL.</p>
<h4>Basic</h4></p>
<p>Let's have a look at the basics, I added some (revised / half the original) debugging output by supplying the <code>-v</code> option.</p>
<pre class="brush:bash">
curl -v -X POST http://localhost:8080/1/stuff/23f96c6bd4c87910c.json -d 'name=Niclas'</p>
<p>> POST /1/stuff/23f96c6bd4c87910c.json HTTP/1.1
> Host: localhost:8080
> Accept: */*
> Content-Length: 11
> Content-Type: application/x-www-form-urlencoded
>
< HTTP/1.1 200 OK
< Content-Type: text/plain; charset=utf-8
< Content-Length: 25
<
Stuff: 23f96c6bd4c87910c
</pre>
There are some options involved:</p>
<ul>
<li><code>-v</code> added the request/response header for debugging</li>
<li><code>-X</code> specified the request method (<code>POST</code>) to use.</li>
<li><code>-d</code> added some data in the request (<code>POST</code>) body.</li>
</ul>
So the <code>'name=Niclas'</code> was sent to the server using the request body, but <code>curl</code> does not display the request body using the <code>-v</code> option.</p>
<h4>Using a JSON body</h4>
So this is nice, when you want to post key-value pairs to your server, but many applications (e.g. <a href="http://couchdb.apache.org/">CouchDB</a> want to post JSON objects to the server. The initial guess</p>
<pre class="brush:bash">
curl -v -X POST http://localhost:8080/1/stuff/23f96c6bd4c87910c.json -d '{"name":"Niclas"}'</p>
<p>Stuff: 23f96c6bd4c87910c, JSON body:
</pre>
does not work. That's where the content type comes in. If you post the JSON whiteout supplying the proper content type <code>curl</code> and/or the server will try to use  <code>application/x-www-form-urlencoded</code><a href="http://www.w3.org/TR/html4/interact/forms.html"><sup>*</sup></a> content type. This is the same content type your browser uses when submitting a form to a web server. Doesn't sound bad, does it?</p>
<p>But it's bad because the JSON will be ignored/dropped/whatever and the server is unable to understand the request. To solve the problem use:</p>
<pre class="brush:bash">
curl -H "Content-Type: application/json" -X POST  http://localhost:8080/1/stuff/23f96c6bd4c87910c.json -d '{"name":"Niclas"}'</p>
<p>Stuff: 23f96c6bd4c87910c, JSON body: {"name":"Niclas"}
</pre></p>
<p>So these options are involved</p>
<ul>
<li><code>-X</code> specified the request method (<code>POST</code>) to use.</li>
<li><code>-H</code> added the header <code>Content-Type: application/json</code> to the request.</li>
<li><code>-d</code> defined the data used for the request body (<code>{"name":"Niclas"}</code>).</li>
</ul></p>
<h4>A JSON file as body</h4>
So far so good. But if you have huge JSON requests, you don't want to type all the JSON into the console. You may use the <code>@</code> symbol in conjunction with the <code>-d</code> option so <code>curl</code> will read the request body contents from a file. This may look like this.</p>
<pre class="brush:bash">
curl -H "Content-Type: application/json" -X POST  http://localhost:8080/1/stuff/23f96c6bd4c87910c.json -d @some-huge-request.json</p>
<p>Stuff: 23f96c6bd4c87910c, JSON body: {"name":"Niclas", ..., "foo":"Bar"}
</pre></p>
<p>A nice trick is, that if you use the <code>-d</code> with <code>@-</code>. <code>curl</code> will read the request body from the standard input. So you can do stuff like this:</p>
<pre class="brush:bash">
cat some-huge-request.json | curl -H "Content-Type: application/json" -X POST  http://localhost:8080/1/stuff/23f96c6bd4c87910c.json -d @-</p>
<p>Stuff: 23f96c6bd4c87910c, JSON body: {"name":"Niclas", ..., "foo":"Bar"}
</pre></p>
<h3>PUTting stuff</h3>
Is much like <code>POST</code>, so if you can <code>POST</code> you can <code>PUT</code>. One nasty little difference is, that you don't have to supply a <code>Content-Type</code> HTTP header for <code>PUT</code>. <code>curl</code> does not use <code>application/x-www-form-urlencoded</code> as content type for <code>PUT</code>. Lost an hour (or so), because I did some <code>PUT</code> stuff before switching to  <code>POST</code>.</p>
<h2>Debugging</h2></p>
<h4>Detailed information</h4>
The key to get almost every information by supplying the <code>-v</code> option to curl.</p>
<pre class="brush:bash">
curl -v https://graph.facebook.com/740999649</p>
<p>* About to connect() to graph.facebook.com port 443 (#0)
*   Trying 66.220.147.38... connected
* Connected to graph.facebook.com (66.220.147.38) port 443 (#0)
* SSLv3, TLS handshake, Client hello (1):
* SSLv3, TLS handshake, Server hello (2):
* SSLv3, TLS handshake, CERT (11):
* SSLv3, TLS handshake, Server finished (14):
* SSLv3, TLS handshake, Client key exchange (16):
* SSLv3, TLS change cipher, Client hello (1):
* SSLv3, TLS handshake, Finished (20):
* SSLv3, TLS change cipher, Client hello (1):
* SSLv3, TLS handshake, Finished (20):
* SSL connection using RC4-MD5
* Server certificate:
* 	 subject: C=US; ST=California; L=Palo Alto; O=Facebook, Inc.; CN=*.facebook.com
* 	 start date: 2010-01-13 00:00:00 GMT
* 	 expire date: 2013-04-11 23:59:59 GMT
* 	 common name: *.facebook.com (matched)
* 	 issuer: C=US; O=DigiCert Inc; OU=www.digicert.com; CN=DigiCert High Assurance CA-3
* 	 SSL certificate verify ok.
> GET /740999649 HTTP/1.1
> User-Agent: curl/7.21.4 (universal-apple-darwin11.0) libcurl/7.21.4 OpenSSL/0.9.8r zlib/1.2.5
> Host: graph.facebook.com
> Accept: */*
>
< HTTP/1.1 200 OK
< Access-Control-Allow-Origin: *
< Cache-Control: private, no-cache, no-store, must-revalidate
< Content-Type: text/javascript; charset=UTF-8
< ETag: "f89bfe40c87e487ae641d427c96746b226a91f3c"
< Expires: Sat, 01 Jan 2000 00:00:00 GMT
< Pragma: no-cache
< X-FB-Rev: 482216
< X-FB-Server: 10.36.50.102
< X-Cnection: close
< Date: Wed, 07 Dec 2011 13:14:19 GMT
< Content-Length: 183
<
* Connection #0 to host graph.facebook.com left intact
* Closing connection #0
* SSLv3, TLS alert, Client hello (1):
{"id":"740999649","name":"Niclas Meier","first_name":"Niclas","last_name":"Meier","link":"http:\/\/www.facebook.com\/people\/Niclas-Meier\/740999649","gender":"male","locale":"de_DE"}</pre>
But for may occasions that is simply too much, so check out the <code>-i</code> option.</p>
<h4>Header information</h4>
Often it's enough to get only the response headers for debugging. To get only these headers just use the <code>-i</code> option in <code>curl</code>.</p>
<pre class="brush:bash">
curl -i https://graph.facebook.com/740999649
HTTP/1.1 200 OK
Access-Control-Allow-Origin: *
Cache-Control: private, no-cache, no-store, must-revalidate
Content-Type: text/javascript; charset=UTF-8
ETag: "f89bfe40c87e487ae641d427c96746b226a91f3c"
Expires: Sat, 01 Jan 2000 00:00:00 GMT
Pragma: no-cache
X-FB-Rev: 482216
X-FB-Server: 10.42.67.29
X-Cnection: close
Date: Wed, 07 Dec 2011 13:18:24 GMT
Content-Length: 183</p>
<p>{"id":"740999649","name":"Niclas Meier","first_name":"Niclas","last_name":"Meier","link":"http:\/\/www.facebook.com\/people\/Niclas-Meier\/740999649","gender":"male","locale":"de_DE"}</pre></p>
